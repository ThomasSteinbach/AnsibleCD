FROM IMAGENAME

ENV all_proxy='http://aci-squid-deb-proxy:8000'
ENV http_proxy='http://aci-squid-deb-proxy:8000'
ENV https_proxy='http://aci-squid-deb-proxy:8000'
ENV ftp_proxy='http://aci-squid-deb-proxy:8000'
ENV HTTP_PROXY='http://aci-squid-deb-proxy:8000'
ENV HTTPS_PROXY='http://aci-squid-deb-proxy:8000'
ENV FTP_PROXY='http://aci-squid-deb-proxy:8000'

RUN if type apt-get &>/dev/null; then \
      echo 'Acquire::HTTP::Proxy "http://aci-squid-deb-proxy:8000";' >> /etc/apt/apt.conf.d/03autoproxy; \
    elif type pacman &>/dev/null; then \
      echo 'Configured by env'; \
    elif type zypper &>/dev/null; then \
      echo 'Proxy not implemented yet'; \
    elif type yum &>/dev/null; then \
      echo 'proxy=http://aci-squid-deb-proxy:8000' >> /etc/yum.conf; \
      rm -f /etc/yum/pluginconf.d/fastestmirror.conf; \
    fi
